{% extends "base.html" %}

{% block container %}
<div class="text-center">
	<h6>현재 정당 데이터는 랜덤으로 입력되어 있으므로, 결과값은 정확하지 않습니다 </h6>

  <h3>정당 유사도 - 2차원</h1>
  <div id="chartContainer"></div>

  <div class="space"></div>

	<h3>정당 유사도 - 1차원</h1>
	<h6 id="record-updated-at"></h6> 
	
	<div id="result-chart"></div>
	<div id="label-list"></div>
	
	<div class="space"></div>
	
	<div class="hidden" id="share-btn-group">
		{# Facebook #}
		<a href="https://www.facebook.com/sharer/sharer.php?u=https://pingkorea.com{{ request.path }}" target="_blank" class="share-btn">
			<img src="http://dl8hm92vwsxic.cloudfront.net/social-media-icon/facebook.svg"/>
		</a>
		{# Twitter #}
		<a href="https://twitter.com/intent/tweet?text=[핑] 당신의 위치를 확인하세요&url=https://pingkorea.com{{ request.path }}" target="_blank" class="share-btn" id="twitter-share">
			<img src="http://dl8hm92vwsxic.cloudfront.net/social-media-icon/twitter.svg" />
		</a>
		{# Google+ #}
		<a href="https://plus.google.com/share?url=https://pingkorea.com{{ request.path }}" target="_blank" class="share-btn">
			<img src="http://dl8hm92vwsxic.cloudfront.net/social-media-icon/google_plus.svg" />
		</a>
		{# LINE #}
		<a href="line://msg/text/[핑] 당신의 위치를 확인하세요 https://pingkorea.com{{ request.path }}" class="share-btn" id="line-share">
			<img src="http://dl8hm92vwsxic.cloudfront.net/social-media-icon/line.svg" />
		</a>
		{# Kakao talk #}
		<a href="javascript:;" class="share-btn" id="kakaotalk-share">
			<img src="http://dl8hm92vwsxic.cloudfront.net/social-media-icon/kakaotalk.svg" />
		</a>
		<h6>공유하면 이 결과를 누구나 볼 수 있습니다.</h6>
		<h6>언제든 비공개로 전환할 수 있습니다.</h6>
	</div>
	
	<div class="space"></div>
	
	<a href="/" class="btn btn-primary btn-lg btn-block" id="move-to-main-page-btn"></a>
	
	<button class="btn btn-primary btn-lg btn-block hidden" id="update-public-field-btn" data-loading-text="업데이트 중입니다">
		비공개로 전환하기
	</button>
	
	<div class="alert alert-info hidden" id="update-public-field-alert-message" role="alert">
		비공개로 전환했습니다
	</div>
	
	<div class="alert alert-danger hidden" id="forbidden-alert-message" role="alert">
		존재하지 않거나 비공개입니다
	</div>

	<div id="chartContainer"></div>
</div>
{% endblock %}


{% block custom_javascript %}
<script type="text/javascript">

	$.ajax({
		url: '/api/results/temp/',
		type: 'GET',
		data: {
			'userID': localStorage.getItem('user_id')
		}
	}).done(function(result) {
		data = result.coordinates_list;

		var chartWidth = $('#chartContainer').width();

		var svg = dimple.newSvg('#chartContainer', chartWidth, chartWidth);

		<!-- this creates the dimple object -->
		var myChart = new dimple.chart(svg, data);

		<!-- sets the bounds for dimple chart -->
		myChart.setBounds(10, 10, chartWidth - 20, chartWidth - 20);
		// myChart.setMargins(100, 100, 100, 100);

		<!-- the addMeasureAxis method literally adds the axis - not just the labels - it adds all the data and gets the 축적 right -->
		var xAxis= myChart.addMeasureAxis("x", "x_coordinates");
		var yAxis = myChart.addMeasureAxis("y", "y_coordinates");
		var zAxis = myChart.addMeasureAxis("z", "z_coordinates");
		xAxis.title = "가로축: 경제";
		xAxis.fontSize = 12;
		yAxis.title = "세로축: 사회";
		yAxis.fontSize = 12;
		var mySeries = myChart.addSeries("name", dimple.plot.bubble);
		<!-- s.stacked = false;-->
		<!-- myChart.addSeries("Brand", dimple.plot.bubble);-->
			
		data.forEach(function(object, index) {
			myChart.assignColor(object.name, object.color);
		});

		mySeries.afterDraw = function (shp, d, i) {
				var shape = d3.select(shp);
				svg.append("text")
						.attr("x", parseFloat(shape.attr("cx")-20))
						.attr("y", parseFloat(shape.attr('cy')))
						.style('test-anchor','middle')
						.style('font-size', '20px')
						.style('font-family', 'sans-serif')
						.style('opacity', 0.7)
						.text(data[i].name)
		};

		myChart.draw(1000);
	}).fail(function(data) {
	}); 
</script>
{% endblock %}
